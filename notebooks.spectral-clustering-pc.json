{"version":2,"kind":"Notebook","sha256":"b70af5050c8947979ffbfa08f27ecc83bd63f6c6267c8c55cc9edbbba66e200d","slug":"notebooks.spectral-clustering-pc","location":"/notebooks/2.0_Spectral_Clustering_PC.ipynb","dependencies":[],"frontmatter":{"title":"Spectral Clustering","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Demetris Roumis","given":"Demetris","family":"Roumis"},"name":"Demetris Roumis","url":"https://github.com/droumis","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/landsat-ml-cookbook","copyright":"2024","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/landsat-ml-cookbook/blob/main/notebooks/2.0_Spectral_Clustering_PC.ipynb","thumbnail":"/landsat-ml-cookbook/build/spectral_clustering-4854a53a6dcd88a162a799ccc691246f.png","exports":[{"format":"ipynb","filename":"2.0_Spectral_Clustering_PC.ipynb","url":"/landsat-ml-cookbook/build/2.0_Spectral_Cluster-9aef19e820a97a34477317595b41d01a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/landsat-ml-cookbook/build/spectral_clustering-4854a53a6dcd88a162a799ccc691246f.png","alt":"Spectral Clustering","title":"Spectral Clustering","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LSPcY2Tghd","urlSource":"images/spectral_clustering.png"}],"key":"EhnzfknkFw"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DQ2xLa8w0K"}],"key":"qnFEG0On71"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xzRHU9qWGZ"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"Ki4T9vxar1"}],"key":"W17RSbzi2k"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The current notebook will demonstrate a simplified machine learning approach to observe the change in a lake waterâ€™s extent across time. In order to identify the water, we can use spectral clustering to classify each grid cell into a category based on the similarity of the combined set of pixels across ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O3nkpBGcEL"},{"type":"link","url":"/notebooks/intro-landsat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"wavelength-bands","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Nv3LTXWO4f"}],"urlSource":"./0.0_Intro_Landsat","dataUrl":"/notebooks.intro-landsat.json","internal":true,"protocol":"file","key":"VrdZmjbKIT"},{"type":"text","value":" in our image stacks.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xHvJTnGMZE"}],"key":"LJN2iUTzvk"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Our example approach uses a version of spectral clustering from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LxlV79WQXM"},{"type":"link","url":"http://ml.dask.org/clustering.html#spectral-clustering","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dask_ml","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z6cvhEH6hy"}],"urlSource":"http://ml.dask.org/clustering.html#spectral-clustering","key":"NEhyZlSlrT"},{"type":"text","value":" that is a scalable equivalent of what is available in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KvmyIW397U"},{"type":"link","url":"https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"scikit-learn","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XACST77iMh"}],"urlSource":"https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering","key":"SDD3vc9D94"},{"type":"text","value":". We will begin this approach with a single image stack and then conduct a direct comparison on the results from different time points.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"tApsMl5CJb"}],"key":"GppKGeoHPQ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This workflow uses data from Microsoft Planetary Computer but it can be adapted to work with any data ingestion approach from this cookbook.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WXweb2NOkQ"}],"key":"WyHZAB6ib4"}],"key":"yy1qAWVEME"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oF2plAZb3m"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"aPnnvJcz6N"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lSDxb4VY0X"}],"key":"fPEKRxIqOY"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KzxJ2bJFR9"}],"key":"walJ6srtpu"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fjQKWrNyzH"}],"key":"uoUAUTn85W"}],"key":"EI4arox4K0"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"/notebooks/data-ingestion-geospatial","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Data Ingestion - Geospatial-Specific Tooling","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PlgoNTgZ3D"}],"urlSource":"1.0_Data_Ingestion-Geospatial.ipynb","dataUrl":"/notebooks.data-ingestion-geospatial.json","internal":true,"protocol":"file","key":"ml95obI4L1"}],"key":"E4xHMs2Ocn"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xk815pGgpS"}],"key":"pNTVNZyD3k"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"lZ0DcFifkG"}],"key":"LzhsCQw62K"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"scikit-learn","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"HfEnXVAnfg"}],"urlSource":"https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering","key":"B6O3bfLONd"}],"key":"QFBcNtimMA"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sAlIPNaVUe"}],"key":"ZpDEUmqBxQ"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Spectral clustering","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"deZPyGZFhi"}],"key":"Ha2kbNYf48"}],"key":"HF2o4gsXCL"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"http://ml.dask.org/clustering.html#spectral-clustering","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"dask_ml","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HZTDyDdXlG"}],"urlSource":"http://ml.dask.org/clustering.html#spectral-clustering","key":"I0awNfnETA"}],"key":"EzALuaAU4s"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"JSp6fKSHB5"}],"key":"nODcwPYZUs"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Spectral clustering at scale","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ttX2OuRCd0"}],"key":"NP6kEkvDlt"}],"key":"bMrihC4iY0"}],"key":"cPGaSr1gnI"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ouoeCHrwWz"}],"key":"P9wkoBNZnq"},{"type":"text","value":": 20 minutes.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"B344F19g06"}],"key":"Ma9FoVVNUe"}],"key":"mb2TOaMkDz"}],"key":"lVLxWaqP7c"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DIS0byfpU7"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"mylyRwBEP6"}],"key":"gyDpeuHjQR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport odc.stac\nimport pandas as pd\nimport planetary_computer\nimport pystac_client\nimport xarray as xr\nfrom dask.distributed import Client\nfrom pystac.extensions.eo import EOExtension as eo\nfrom dask_ml.cluster import SpectralClustering\nimport pyproj\n\n# Viz\nimport hvplot.xarray","key":"xpFltEBVTc"},{"type":"output","id":"zrXYf_to85OSPA4EYPPWM","data":[{"output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mImportError\u001b[0m                               Traceback (most recent call last)\nCell \u001b[0;32mIn[1], line 7\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mpystac_client\u001b[39;00m\n\u001b[1;32m      6\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mxarray\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mxr\u001b[39;00m\n\u001b[0;32m----> 7\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdask\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m Client\n\u001b[1;32m      8\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mpystac\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mextensions\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01meo\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m EOExtension \u001b[38;5;28;01mas\u001b[39;00m eo\n\u001b[1;32m      9\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdask_ml\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcluster\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m SpectralClustering\n\nFile \u001b[0;32m~/micromamba/envs/landsat-ml-cookbook/lib/python3.10/site-packages/dask/distributed.py:13\u001b[0m\n\u001b[1;32m      5\u001b[0m _import_error_message \u001b[38;5;241m=\u001b[39m (\n\u001b[1;32m      6\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mdask.distributed is not installed.\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m      7\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mPlease either conda or pip install distributed:\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m      8\u001b[0m     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m  conda install dask distributed             # either conda install\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m      9\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m  python -m pip install \u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mdask[distributed]\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m --upgrade    # or pip install\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m     10\u001b[0m )\n\u001b[1;32m     12\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m---> 13\u001b[0m     \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;241m*\u001b[39m\n\u001b[1;32m     14\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mImportError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:\n\u001b[1;32m     15\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m e\u001b[38;5;241m.\u001b[39mmsg \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mNo module named \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdistributed\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\nFile \u001b[0;32m~/micromamba/envs/landsat-ml-cookbook/lib/python3.10/site-packages/distributed/__init__.py:23\u001b[0m\n\u001b[1;32m     20\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdask\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mconfig\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m config  \u001b[38;5;66;03m# type: ignore\u001b[39;00m\n\u001b[1;32m     22\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01m_version\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m get_versions\n\u001b[0;32m---> 23\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mactor\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m Actor, ActorFuture, BaseActorFuture\n\u001b[1;32m     24\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mclient\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m (\n\u001b[1;32m     25\u001b[0m     Client,\n\u001b[1;32m     26\u001b[0m     CompatibleExecutor,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m     35\u001b[0m     wait,\n\u001b[1;32m     36\u001b[0m )\n\u001b[1;32m     37\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcore\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m Status, connect, rpc\n\nFile \u001b[0;32m~/micromamba/envs/landsat-ml-cookbook/lib/python3.10/site-packages/distributed/actor.py:13\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mtyping\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m Generic, Literal, NoReturn, TypeVar\n\u001b[1;32m     11\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mtornado\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mioloop\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m IOLoop\n\u001b[0;32m---> 13\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mclient\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m Future\n\u001b[1;32m     14\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mprotocol\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m to_serialize\n\u001b[1;32m     15\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdistributed\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mutils\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m LateLoopEvent, iscoroutinefunction, sync, thread_state\n\nFile \u001b[0;32m~/micromamba/envs/landsat-ml-cookbook/lib/python3.10/site-packages/distributed/client.py:34\u001b[0m\n\u001b[1;32m     31\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mtlz\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m first, groupby, merge, partition_all, valmap\n\u001b[1;32m     33\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdask\u001b[39;00m\n\u001b[0;32m---> 34\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdask\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mbase\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m collections_to_dsk, normalize_token, tokenize\n\u001b[1;32m     35\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdask\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcore\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m flatten, validate_key\n\u001b[1;32m     36\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21;01mdask\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mhighlevelgraph\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m HighLevelGraph\n\n\u001b[0;31mImportError\u001b[0m: cannot import name 'collections_to_dsk' from 'dask.base' (/home/runner/micromamba/envs/landsat-ml-cookbook/lib/python3.10/site-packages/dask/base.py)","ename":"ImportError","evalue":"cannot import name 'collections_to_dsk' from 'dask.base' (/home/runner/micromamba/envs/landsat-ml-cookbook/lib/python3.10/site-packages/dask/base.py)"}],"key":"YSPCj8eDTi"}],"key":"kHTUS2B2EA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Loading Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qE9PdxBTuP"}],"identifier":"loading-data","label":"Loading Data","html_id":"loading-data","implicit":true,"key":"kXCV8rcQ1z"}],"key":"Mz5vqUq60r"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Letâ€™s start by loading some Landsat data. These steps are covered in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iKNIhIbsnG"},{"type":"link","url":"1.0_Data_Ingestion-Planetary_Computer.ipynb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Ingestion - Planetary Computer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AlRFjO6LEO"}],"urlSource":"1.0_Data_Ingestion-Planetary_Computer.ipynb","key":"kCzzpFSrsI"},{"type":"text","value":" prerequisite.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MMegipii1n"}],"key":"dzxH6Ijzuf"}],"key":"moOO2Xl1mU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Search the catalog","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W97RQW922s"}],"identifier":"search-the-catalog","label":"Search the catalog","html_id":"search-the-catalog","implicit":true,"key":"xawiLEwxl3"}],"key":"cc0hcjlwq5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"catalog = pystac_client.Client.open(\n    \"https://planetarycomputer.microsoft.com/api/stac/v1\",\n    modifier=planetary_computer.sign_inplace,\n)\n\nbbox = [-118.89, 38.54, -118.57, 38.84]  # Region over a lake in Nevada, USA\ndatetime = \"2017-06-01/2017-09-30\"  # Summer months of 2017\ncollection = \"landsat-c2-l2\"\nplatform = \"landsat-8\"\ncloudy_less_than = 1  # percent\n\nsearch = catalog.search(\n    collections=[\"landsat-c2-l2\"],\n    bbox=bbox,\n    datetime=datetime,\n    query={\"eo:cloud_cover\": {\"lt\": cloudy_less_than}, \"platform\": {\"in\": [platform]}},\n)\nitems = search.get_all_items()\nprint(f\"Returned {len(items)} Items:\")\n[[i, item.id] for i, item in enumerate(items)]","key":"qKkHLq0xPG"},{"type":"output","id":"EJblC9cRG7OY-aK-_8-1z","data":[],"key":"RxZ7l2lXW3"}],"key":"rxIuWoCx9g"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load a dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C78EJ9ZaMx"}],"identifier":"load-a-dataset","label":"Load a dataset","html_id":"load-a-dataset","implicit":true,"key":"EC7hSBQVhV"}],"key":"qH9m1Au8Pw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"item = items[1]  # select one of the results","key":"kwnMi4CBeX"},{"type":"output","id":"jzYCBAV3QM1r0i5LFPmGp","data":[],"key":"M63Q67n6Z5"}],"key":"ZPQ9Twhn0x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"assets = []\nfor _, asset in item.assets.items():\n    try:\n        assets.append(asset.extra_fields[\"eo:bands\"][0])\n    except:\n        pass\n\ncols_ordered = [\n    \"common_name\",\n    \"description\",\n    \"name\",\n    \"center_wavelength\",\n    \"full_width_half_max\",\n]\nbands = pd.DataFrame.from_dict(assets)[cols_ordered]\nbands","key":"DEgv3f8Zme"},{"type":"output","id":"OgwKFEDjI2R1eofdASqbp","data":[],"key":"uNDbRMxvZD"}],"key":"m9ovpScctz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_2017 = odc.stac.stac_load(\n    [item],\n    bands=bands.common_name.values,\n    bbox=bbox,\n    chunks={},  # <-- use Dask\n).isel(time=0)","key":"OE7C9lPenb"},{"type":"output","id":"cOZNo36mJ-uhG13wyNMrR","data":[],"key":"GkPcH08TBB"}],"key":"bIlYlKHdfW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Retain CRS Attribute","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ndASzCk4M7"}],"identifier":"retain-crs-attribute","label":"Retain CRS Attribute","html_id":"retain-crs-attribute","implicit":true,"key":"kZIW809Tll"}],"key":"X62Azkuw1S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"epsg = item.properties[\"proj:epsg\"]\nds_2017.attrs[\"crs\"] = f\"epsg:{epsg}\"","key":"e60qz9afYW"},{"type":"output","id":"SNdIyvwYiBnwr1NHIcXPK","data":[],"key":"bFnSgqR2e7"}],"key":"DUEyMCfuF2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"da_2017 = ds_2017.to_array(dim=\"band\")\nda_2017","key":"ZHRn2WBpKA"},{"type":"output","id":"9EKEnCDoSfW0K74Afeigf","data":[],"key":"JZAQays2Ly"}],"key":"oM7GBDWMjL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reshaping Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DWysc3MJB9"}],"identifier":"reshaping-data","label":"Reshaping Data","html_id":"reshaping-data","implicit":true,"key":"TegCJNp7Eg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The shape of our data is currently ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OSAyAOpf5i"},{"type":"inlineCode","value":"n_bands","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q6NuYTfX8K"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MfbPTrEYYO"},{"type":"inlineCode","value":"n_y","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ApY0PJxuiZ"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OYr2UljKDV"},{"type":"inlineCode","value":"n_x","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Mqil8Mfr1I"},{"type":"text","value":". In order for dask-ml / scikit-learn to consume our data, weâ€™ll need to reshape our image stacks into ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XDspxHOrZR"},{"type":"inlineCode","value":"n_samples, n_features","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p7Pc5CfIvW"},{"type":"text","value":", where ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jmWQjs7Vq9"},{"type":"inlineCode","value":"n_features","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MrnW9up1Y0"},{"type":"text","value":" is the number of wavelength-bands and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GZYWxy6OLj"},{"type":"inlineCode","value":"n_samples","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AaVfNywcIq"},{"type":"text","value":" is the total number of pixels in each wavelength-band image. Essentially, weâ€™ll be creating a vector of pixels out of each image, where each pixel has multiple features (bands), but the ordering of the pixels is no longer relevant to the computation.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hdXkereos3"}],"key":"uGabH0Cvtn"}],"key":"x5jyYeNHAh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By using xarray methods to flatten the data, we can keep track of the coordinate labels â€˜xâ€™ and â€˜yâ€™ along the way. This means that we have the ability to reshape back to our original array at any time with no information loss!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kyzberIy2I"}],"key":"H7wFuHNrev"}],"key":"GhQdxKdmMD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"flattened_xda = da_2017.stack(z=(\"x\", \"y\"))  # flatten each band\nflattened_t_xda = flattened_xda.transpose(\"z\", \"band\")\nflattened_t_xda","key":"cckFpXjO3T"},{"type":"output","id":"fUfvWQPGmOkJacmIMklWN","data":[],"key":"uO8BWihy19"}],"key":"Jb8aUIcair"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Standardize Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VvyRbx3tu7"}],"identifier":"standardize-data","label":"Standardize Data","html_id":"standardize-data","implicit":true,"key":"PiNEC7rNRl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that we have the data in the correct shape, letâ€™s standardize (or rescale) the values of the data. We do this to get all the flattened image vectors onto a common scale while preserving the differences in the ranges of values. Again, weâ€™ll demonstrate doing this first in NumPy and then xarray.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LUwUEaGaJE"}],"key":"vJV19Wpf4J"}],"key":"yjFsRdI6q6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"with xr.set_options(keep_attrs=True):\n    rescaled_xda = (flattened_t_xda - flattened_t_xda.mean()) / flattened_t_xda.std()\nrescaled_xda","key":"hPCR73WtYI"},{"type":"output","id":"vluTESKI15oBbHRACVVr6","data":[],"key":"ncaORwooNk"}],"key":"FbtBN7RDxG"},{"type":"block","kind":"notebook-content","children":[{"type":"div","class":"admonition alert alert-info","children":[{"type":"paragraph","children":[{"type":"text","value":"Info","key":"KMUGJawQxe"}],"key":"oKaNKS6NVD"},{"type":"text","value":"Above, we are using a context manager \"with xr.set_options(keep_attrs=True):\" to retain the array's attributes through the operations. That is, we want any metadata like 'crs' to stay with our result so we can use 'geo=True' in our plotting.","key":"CWVrAw0ere"}],"key":"irNZzxReok"}],"key":"AwKIkOJk1K"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qmuGQOQtCB"},{"type":"inlineCode","value":"rescaled_xda","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ccB96MiKB9"},{"type":"text","value":" is still a Dask object, if we wanted to actually run the rescaling at this point (provided that all the data can fit into memory), we would use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mbunADaNCk"},{"type":"inlineCode","value":"rescaled_xda.compute()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QYELYqyc85"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y10hhOgWLT"}],"key":"jyQS3RFbgz"}],"key":"JxQSd1NfRI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"ML pipeline","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FipAHWPC5M"}],"identifier":"ml-pipeline","label":"ML pipeline","html_id":"ml-pipeline","implicit":true,"key":"tqBgGNlmI6"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that our data is in the proper shape and value range, we are ready to conduct spectral clustering. Here we will use a version of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KLfG3BUR3z"},{"type":"link","url":"https://ml.dask.org/modules/generated/dask_ml.cluster.SpectralClustering.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"spectral clustering from dask_ml","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n4x0qIIW6B"}],"urlSource":"https://ml.dask.org/modules/generated/dask_ml.cluster.SpectralClustering.html","key":"kzk2eOZRM2"},{"type":"text","value":" that is a scalable equivalent to operations from Scikit-learn that cluster pixels based on similarity (across all wavelength-bands, which makes it spectral clustering by spectra!)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C93tLXV0HC"}],"key":"IdKzV9nm6U"}],"key":"pW4twqcVCj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"client = Client(processes=False)\nclient","key":"Wk0yBxcErO"},{"type":"output","id":"ddwqtp1AurCLesfW70MXT","data":[],"key":"t4sqXWATEm"}],"key":"mvoYeVZcdY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we will compute and persist the rescaled data to feed into the ML pipeline. Notice that our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GqCWpXFKPZ"},{"type":"inlineCode","value":"X","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jZVQBDASC0"},{"type":"text","value":" matrix below has the shape: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"so42m5q2ID"},{"type":"inlineCode","value":"n_samples, n_features","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PFEYfMWt3T"},{"type":"text","value":" as discussed earlier.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IzNA1V5G7V"}],"key":"QIHJFmeJpR"}],"key":"fzunK0iPdk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"X = client.persist(rescaled_xda)\nX.shape","key":"SIM0uwMF8y"},{"type":"output","id":"K6fCw3qeQiXdNjZ_3Clhi","data":[],"key":"oGVtIaPcfD"}],"key":"oDaVYKUYZD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First we will set up the model with the number of clusters, and other options.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ujd2ZABjSY"}],"key":"ZQgrBxnNLt"}],"key":"hHPuGX0oIk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"clf = SpectralClustering(\n    n_clusters=4,\n    random_state=0,\n    gamma=None,\n    kmeans_params={\"init_max_iter\": 5},\n    persist_embedding=True,\n)","key":"yuut7n7r3x"},{"type":"output","id":"UdDYpxyuYNjWVceJPR7vR","data":[],"key":"r5sCZiU7yT"}],"key":"KYHz1UB3MJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This next step is the slow part.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jz2Rs7lyXf"}],"key":"n0QPL6hvm4"},{"type":"text","value":" Weâ€™ll fit the model to our matrix ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C3n1DJwOAQ"},{"type":"inlineCode","value":"X","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GpeZTO635o"},{"type":"text","value":". Depending on your setup, it could take seconds to minutes to run depending on the size of our data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v8xMnZzIkY"}],"key":"MVKUcyCOn6"}],"key":"lDIiRlIjp1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time clf.fit(X)","key":"STeCcwqJjU"},{"type":"output","id":"zeYFJxCNKaoeR_N7i2iNR","data":[],"key":"rHDS6KpljH"}],"key":"wvPi0Cvm3j"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Letâ€™s check the shape of the result:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QRH6OCKJqb"}],"key":"bO4vhN7ebh"}],"key":"s9VMiOFHEM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"labels = clf.assign_labels_.labels_.compute()\nlabels.shape","key":"MJLi7WZYfp"},{"type":"output","id":"oHJIvOiI1Rec7svEP73c8","data":[],"key":"LqSs3dSx6Y"}],"key":"Ql3rLME3cN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"labels","key":"GxLwaEflYe"},{"type":"output","id":"ZkeDpFUvXRtpyG56V5Pp6","data":[],"key":"eWELAKV3q5"}],"key":"RmBjwbr4Sn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The result is a single vector of cluster labels.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"elvcI5crU4"}],"key":"Z7MwmjksyS"}],"key":"SIqMyHN7d9"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Un-flattening","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eD2n5LZXda"}],"identifier":"un-flattening","label":"Un-flattening","html_id":"un-flattening","implicit":true,"key":"Busx0Nl3As"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Once the computation is done, we can use the coordinates of our input array to restack our output array back into an image. Again, one of the main benefits of using ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"vqEzAG99DE"},{"type":"inlineCode","value":"xarray","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rKLSv2Noiq"},{"type":"text","value":" for this stacking and unstacking is that it keeps track of the coordinate information for us.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"c8ko6y2rZW"}],"key":"KJn2Fdw5gP"}],"visibility":"show","key":"jhGdYsbM2s"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since the original array is n_samples by n_features (90000, 6) and the cluster label output is (90000,), we just need the coordinates from one of the original features in the shape of n_samples. We can just copy the coordinates from the first input feature and populate is with our output data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zS2YogtRpJ"}],"key":"jBHRi8ct4j"}],"key":"go3EdLuV17"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"template = flattened_t_xda[:, 0]\noutput_array = template.copy(data=labels)\noutput_array","key":"JxYcosn431"},{"type":"output","id":"UMe6AdkrEqyUlTdpg4Q6h","data":[],"key":"lYF73nL9YC"}],"key":"GoSioIpglc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"With this new output array with coordinates copied from the input array, we can unstack back to the original ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N7cSeFSmNp"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y8EodZZPq3"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h2gsYlC4Uf"},{"type":"inlineCode","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fMH6KbunXd"},{"type":"text","value":" image dimensions by just using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LBOCiFTZ4P"},{"type":"inlineCode","value":".unstack()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WVeVBnwD8o"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OO6q7lAg4P"}],"key":"yj8vO7x163"}],"key":"jLEsB4JfD3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"unstacked_2017 = output_array.unstack()\nunstacked_2017","key":"dc0ecf69Hm"},{"type":"output","id":"Lw-8XBHiiU9Xa2iOs3oRa","data":[],"key":"BIlFkq7Aeo"}],"key":"x6ySnrGMeE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finally, we can visualize the results! By hovering over the resulting imge, we can see that the lake water has been clustered with a certain label or â€˜valueâ€™.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ehLmUmAdyZ"}],"key":"Qw707aDnl9"}],"key":"gVdXTZ051I"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"raw_plot_2017 = da_2017.sel(band=\"red\").hvplot.image(\n    x=\"x\", y=\"y\", geo=True, xlabel=\"lon\", ylabel=\"lat\", datashade=True, cmap=\"greys\", title=\"Raw Image 2017\",\n)\n\nresult_plot_2017 = unstacked_2017.hvplot(\n    x=\"x\", y=\"y\", cmap=\"Set3\", geo=True, xlabel=\"lon\", ylabel=\"lat\", colorbar=False,  title=\"Spectral Clustering 2017\",\n)\n\nraw_plot_2017 + result_plot_2017","key":"wHLu72cO3q"},{"type":"output","id":"9xn8xQBLEZbadrySM3LEE","data":[],"key":"S7BeNO9ABT"}],"key":"D1hKesBISL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spectral Clustering for 1988","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KTeQfvE32i"}],"identifier":"spectral-clustering-for-1988","label":"Spectral Clustering for 1988","html_id":"spectral-clustering-for-1988","implicit":true,"key":"s5rzKxd4hX"}],"key":"O2AenqzyZv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have conducted the spectral clustering for 2017 and now we want to compare this result to the lake in 1988. Letâ€™s load data from 1988 and run the same analysis as above.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"obHQ4Mcpnz"}],"key":"upa8NPF6up"}],"key":"HoROm2IyT4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will use the same catalog, but we will search it for a different point in time and different Landsat mission","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"McbayXISCs"}],"key":"pEcdV5pz7U"}],"key":"iSjoj7baPZ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FcCjIeQ3Qp"}],"identifier":"load-the-data","label":"Load the data","html_id":"load-the-data","implicit":true,"key":"Zn40O11yCD"}],"key":"yRZ8oW4OpS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bbox = [-118.89, 38.54, -118.57, 38.84]  # Region over a lake in Nevada, USA\ndatetime = \"1988-06-01/1988-09-30\"  # Summer months of 1988\ncollection = \"landsat-c2-l2\"\nplatform = \"landsat-5\"  # Searching through an earlier landsat mission\ncloudy_less_than = 1  # percent\n\nsearch = catalog.search(\n    collections=[\"landsat-c2-l2\"],\n    bbox=bbox,\n    datetime=datetime,\n    query={\"eo:cloud_cover\": {\"lt\": cloudy_less_than}, \"platform\": {\"in\": [platform]}},\n)\n\nitems = search.get_all_items()\nitem = items[1]  # select one of the results","key":"ZcDgFJsphH"},{"type":"output","id":"GIQl4BJeeHcwgPaaWrS_D","data":[],"key":"lrqEmLR42W"}],"key":"i15MVniiBR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice that Landsat 5 data from 1988 has slightly different spectra than Landsat 8 from 2017. Details like this are important to keep in mind when performing analyses that directly compare across missions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TGlRB8Ruyo"}],"key":"C8CXEFLAAP"}],"key":"m9TgRyehQZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"assets = []\nfor _, asset in item.assets.items():\n    try:\n        assets.append(asset.extra_fields[\"eo:bands\"][0])\n    except:\n        pass\n\ncols_ordered = [\n    \"common_name\",\n    \"description\",\n    \"name\",\n    \"center_wavelength\",\n    \"full_width_half_max\",\n]\nbands = pd.DataFrame.from_dict(assets)[cols_ordered]\nbands","key":"BdsUlrLlcB"},{"type":"output","id":"jKFvRGcAjVLXeukdQP-MF","data":[],"key":"SjsprAt2je"}],"key":"ITtSpLQnIy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_1988 = odc.stac.stac_load(\n    [item],\n    bands=bands.common_name.values,\n    bbox=bbox,\n    chunks={},  # <-- use Dask\n).isel(time=0)\n\nepsg = item.properties[\"proj:epsg\"]\nds_1988.attrs[\"crs\"] = f\"epsg:{epsg}\"\n\nda_1988 = ds_1988.to_array(dim=\"band\")\nda_1988","key":"zFLq47ntCJ"},{"type":"output","id":"8QRxbOLP8FUfynTag_GPc","data":[],"key":"W1TjiK5WWm"}],"key":"XOf4fDc9z0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reshape and Standardize","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ERCYEE4rcE"}],"identifier":"reshape-and-standardize","label":"Reshape and Standardize","html_id":"reshape-and-standardize","implicit":true,"key":"eo06NJPuco"}],"key":"BeVTy1CXwA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"flattened_xda = da_1988.stack(z=(\"x\", \"y\"))\nflattened_t_xda = flattened_xda.transpose(\"z\", \"band\")\nwith xr.set_options(keep_attrs=True):\n    rescaled_xda = (flattened_t_xda - flattened_t_xda.mean()) / flattened_t_xda.std()\nrescaled_xda","key":"JjhtgByQ6v"},{"type":"output","id":"4SiXwFlc_QYWZ_Lks94PA","data":[],"key":"KUrlqNw5MY"}],"key":"K94sgbnp50"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spectral Clustering","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iLzj3cSHjg"}],"identifier":"spectral-clustering","label":"Spectral Clustering","html_id":"spectral-clustering","implicit":true,"key":"VbjSnvlmLq"}],"key":"WgzK61SyCF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"X = client.persist(rescaled_xda)\nclf = SpectralClustering(\n    n_clusters=4,\n    random_state=0,\n    gamma=None,\n    kmeans_params={\"init_max_iter\": 5},\n    persist_embedding=True,\n)","key":"s0pQDGQlNh"},{"type":"output","id":"mw9RJswgD1EwGAcLmGFxP","data":[],"key":"lU81GN6iKP"}],"key":"ZKsuSioG05"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time clf.fit(X)","key":"s6gJlQkPUc"},{"type":"output","id":"GSnMu92uIKvb6zqIxYuTs","data":[],"key":"QG2SKd4Cdv"}],"key":"UWPuRI6cP2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"labels = clf.assign_labels_.labels_.compute()\nlabels.shape","key":"MAERDsyXLS"},{"type":"output","id":"SqVNup2ZctKkmqYjWE1PT","data":[],"key":"qAJRWymsTK"}],"key":"iVlioPiDtY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"labels","key":"FGRDqEdOzz"},{"type":"output","id":"et-LKyHY5nxrK2Yda5DHm","data":[],"key":"HDTyuFwgXW"}],"key":"g3KEhZZZNQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Unstack and Visualize","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V4AKzKQ4OO"}],"identifier":"unstack-and-visualize","label":"Unstack and Visualize","html_id":"unstack-and-visualize","implicit":true,"key":"d6V4xiJ25c"}],"key":"mjVJxNSnp3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"template = flattened_t_xda[:, 0]\noutput_array = template.copy(data=labels)\nunstacked_1988 = output_array.unstack()","key":"sHOTpXGeZe"},{"type":"output","id":"PyvKeOzri-S3lbJt935tR","data":[],"key":"BdwJasxaay"}],"key":"zTLNILn1DT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"unstacked_1988","key":"fItTt77X6a"},{"type":"output","id":"SrOhH5JTGE8snSLpiB0jc","data":[],"key":"n93MwV8XYa"}],"key":"J6zc72ySqd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"raw_plot_1988 = da_1988.sel(band=\"red\").hvplot.image(\n    x=\"x\", y=\"y\", geo=True, xlabel=\"lon\", ylabel=\"lat\", datashade=True, cmap=\"greys\", title=\"Raw 1988\"\n)\n\nresult_plot_1988 = unstacked_1988.hvplot(\n    x=\"x\", y=\"y\", cmap=\"Set3\", geo=True, xlabel=\"lon\", ylabel=\"lat\", colorbar=False, title=\"Spectral Clustering 1988\",\n)\n\nraw_plot_1988 + result_plot_1988","key":"JLB63DZ3UL"},{"type":"output","id":"EyRy0yjcvLBv0WJNyL8tl","data":[],"key":"P5s27WqtOJ"}],"key":"FZHHBnLKm4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Spectral Clustering Over Time","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TXhDynhCBH"}],"identifier":"spectral-clustering-over-time","label":"Spectral Clustering Over Time","html_id":"spectral-clustering-over-time","implicit":true,"key":"Cvgv2Ofom8"}],"key":"XxutAqdA1U"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our hypothesis is that the lakeâ€™s area is receding over time and so we want to visualize the potential change. Letâ€™s first visually compare the plot of the clustering results from the different time points.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r31mZqpU4I"}],"key":"E7u90kcYFE"}],"key":"vc6550Hu1P"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"result_plot_1988 + result_plot_2017","key":"blhMM0c4JE"},{"type":"output","id":"rLIIG0kVKn4kxj8OENZ4F","data":[],"key":"TxOrN89qSO"}],"key":"gN96Czf0q0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"By hovering over the lake in each image, we can see that the water was labeled (â€˜valueâ€™) with a certain cluster number in both images. We will programmatically grab the water cluster value from the middle of the lake using pyproj to convert from longtitude/latitude coordinates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lvG332y32S"}],"key":"aFBH2Hzr0e"}],"key":"ESNGEgXQc9"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"lon_lake_center = -118.71\nlat_lake_center = 38.7\n\nproj = pyproj.Proj(unstacked_1988.crs)\nlake_center_x, lake_center_y = proj(lon_lake_center, lat_lake_center)\n\nwater_cluster_1988 = int(unstacked_1988.sel(x=lake_center_x, y=lake_center_y, method='nearest'))\nwater_cluster_2017 = int(unstacked_2017.sel(x=lake_center_x, y=lake_center_y, method='nearest'))\n\nprint('water cluster values:', water_cluster_1988, water_cluster_2017)","visibility":"show","key":"Q0hA9LBEBE"},{"type":"output","id":"IRh9jLwDqrOQl5CIspRxG","data":[],"visibility":"show","key":"dgAlefX4xA"}],"visibility":"show","key":"UTEkqDNvX5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, letâ€™s set any value that isnâ€™t our water cluster label to 0.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RR2v1bEj5b"}],"key":"KEoPGgCkDC"}],"key":"T4sOYuqw2l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"with xr.set_options(keep_attrs=True):\n    water_1988 = (unstacked_1988 == water_cluster_1988).astype(int)\n    water_2017 = (unstacked_2017 == water_cluster_2017).astype(int)\n","key":"JjZBzOSZ4U"},{"type":"output","id":"iil5iLj894cENclK5DPgA","data":[],"key":"f2bpO9eH5h"}],"key":"ldcDhK1gSt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"water_1988_plot = water_1988.hvplot(\n    x=\"x\", y=\"y\", cmap=\"greys\", geo=True, colorbar=False, title=\"1988 Water\"\n)\n\nwater_2017_plot = water_2017.hvplot(\n    x=\"x\", y=\"y\", cmap=\"greys\", geo=True, colorbar=False, title=\"2017 Water\"\n)\n\nwater_1988_plot + water_2017_plot","key":"YRFiR2wXey"},{"type":"output","id":"fyohKWrkg4yc7t2a6ohCz","data":[],"key":"DlOWpycQZt"}],"key":"OvfjfUWa5S"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can take the difference of these water label arrays to see exactly where the water levels has changed.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gtJDRUfvWp"}],"key":"FCFxyl4Fbc"}],"key":"DywzUmTce1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"with xr.set_options(keep_attrs=True):\n    water_diff = water_1988 - water_2017","key":"Zk6jUWoJrX"},{"type":"output","id":"KBy3ucHcW9e30Oo5PG69-","data":[],"key":"Vh3DHz52dF"}],"key":"GK3DzKLaoi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Red pixels (array value â€˜1â€™) of our image below are where water was lost from 1988 to 2017.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xVuXu4EmZ1"}],"key":"bV6UtZZeiI"}],"key":"qqICzM05T6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"water_diff.hvplot(\n    x=\"x\", y=\"y\", cmap='coolwarm', geo=True, xlabel=\"long\", ylabel=\"lat\", colorbar=False, title=\"Water Change 1988-2017\",\n)","key":"SJ38oilUop"},{"type":"output","id":"aCnw9j-ZkZ3y2eOBbTEZR","data":[],"key":"ZptnSGNFQl"}],"key":"iiXgfXMRPF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We did it! We are observing the change in the lake shoreline over time using a simple spectral clustering approach.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OgqiQ7NJtm"}],"key":"fgRy0885LO"}],"key":"dVGymqS21O"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Letâ€™s finish things off by adding some geo tiles as a background. To only display the colored pixels overlaid on geo tiles, we could either set the arrayâ€™s background value (â€˜0â€™) to â€˜Not a Numberâ€™ (NaN), or we could just inform hvPlot that we want the background valued pixels to be transparent with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BAq1RBxWPR"},{"type":"inlineCode","value":".redim.nodata(value=0)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X3p27sXG89"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jiZ9vyUJIx"}],"key":"QJC7XyuYC4"}],"key":"yrW5uf6DS8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"water_diff.hvplot(\n        x=\"x\", y=\"y\", width=400, height=400, cmap='coolwarm', geo=True, xlabel=\"lon\", ylabel=\"lat\", alpha=1, colorbar=False, title=\"Water Loss from 1988 to 2017\", tiles=\"ESRI\",\n).redim.nodata(value=0)\n\n","key":"ZRG2NP6dne"},{"type":"output","id":"CHxABe-ZeRtw5wIP1Wnx7","data":[],"key":"QEOZIcsWte"}],"key":"HmX8wT6etO"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PyjgMXECBB"}],"key":"jncF9fJujG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SehQEZrmyf"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"ZciZ4i8D1s"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Starting from raw Landsat data, we have used a simple spectral clustering approach to observe the change in a lake waterâ€™s extent across time.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RvskdKPI48"}],"key":"IoHE4cXDYX"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Whatâ€™s next?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZiPfjlQSXc"}],"identifier":"whats-next","label":"Whatâ€™s next?","html_id":"whats-next","implicit":true,"key":"enrShLvfU1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Adapt this notebook for your own use case or select another workflow example notebook.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"esv3DIib18"}],"key":"ZsBXAPAFUW"}],"key":"T29v0BWqOT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and References","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PSeIsC9tMR"}],"identifier":"resources-and-references","label":"Resources and References","html_id":"resources-and-references","implicit":true,"key":"MpoQRn3AWM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Authored by Demetris Roumis circa Jan, 2023","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SpWdO8Wl2V"}],"key":"PSJyXWSpvo"}],"key":"jpD0qEZEgH"}],"key":"EdDG1DibIA"}],"key":"IsX5NRPnqe"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Data Ingestion - General Purpose Tooling","url":"/notebooks/data-ingestion-general","group":"Foundations"}}},"domain":"http://localhost:3000"}